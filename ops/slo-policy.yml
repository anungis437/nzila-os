# ──────────────────────────────────────────────────────────────────────────────
# Nzila OS — SLO Policy
#
# Defines Service Level Objective thresholds for all NzilaOS applications.
# Used by CI gating to block pilot/prod deployments when thresholds are violated.
#
# Enforcement:
#   - dev/staging: thresholds enforced but violations are warnings only
#   - pilot: thresholds enforced — deploy blocked if violated
#   - prod: thresholds enforced — deploy blocked if violated
#
# @see scripts/slo-gate.ts for CI enforcement logic
# ──────────────────────────────────────────────────────────────────────────────

version: "1.0"
lastUpdated: "2026-02-28"

# ── Global defaults ────────────────────────────────────────────────────────

defaults:
  performance:
    p95_latency_ms: 500
    p99_latency_ms: 2000
    error_rate_max_pct: 2.0
  integrations:
    success_rate_min_pct: 99.0
    p95_delivery_latency_ms: 5000
  dlq:
    backlog_max: 100

# ── Per-app overrides ──────────────────────────────────────────────────────

apps:
  abr:
    performance:
      p95_latency_ms: 400
      p99_latency_ms: 1500
      error_rate_max_pct: 1.5
    integrations:
      success_rate_min_pct: 99.5
      p95_delivery_latency_ms: 3000
    dlq:
      backlog_max: 50

  nacp-exams:
    performance:
      p95_latency_ms: 300
      p99_latency_ms: 1000
      error_rate_max_pct: 1.0
    integrations:
      success_rate_min_pct: 99.5
      p95_delivery_latency_ms: 3000
    dlq:
      backlog_max: 25

  console:
    performance:
      p95_latency_ms: 600
      p99_latency_ms: 2500
      error_rate_max_pct: 3.0

  web:
    performance:
      p95_latency_ms: 500
      p99_latency_ms: 2000
      error_rate_max_pct: 2.0

  orchestrator-api:
    performance:
      p95_latency_ms: 200
      p99_latency_ms: 800
      error_rate_max_pct: 1.0
    integrations:
      success_rate_min_pct: 99.9
      p95_delivery_latency_ms: 2000
    dlq:
      backlog_max: 10

  trade:
    performance:
      p95_latency_ms: 200
      p99_latency_ms: 500
      error_rate_max_pct: 0.5
    integrations:
      success_rate_min_pct: 99.9
      p95_delivery_latency_ms: 1000
    dlq:
      backlog_max: 5

  cfo:
    performance:
      p95_latency_ms: 500
      p99_latency_ms: 2000
      error_rate_max_pct: 2.0

  zonga:
    performance:
      p95_latency_ms: 400
      p99_latency_ms: 1500
      error_rate_max_pct: 2.0

  shop-quoter:
    performance:
      p95_latency_ms: 400
      p99_latency_ms: 1500
      error_rate_max_pct: 2.0

  union-eyes:
    performance:
      p95_latency_ms: 500
      p99_latency_ms: 2000
      error_rate_max_pct: 2.0

  partners:
    performance:
      p95_latency_ms: 500
      p99_latency_ms: 2000
      error_rate_max_pct: 2.0

  pondu:
    performance:
      p95_latency_ms: 600
      p99_latency_ms: 3000
      error_rate_max_pct: 3.0

  cora:
    performance:
      p95_latency_ms: 1000
      p99_latency_ms: 5000
      error_rate_max_pct: 3.0

# ── Gating environments ───────────────────────────────────────────────────

gating:
  # Environments where SLO violations BLOCK deployment
  enforced_environments:
    - pilot
    - prod
  # Environments where SLO violations are WARNINGS only
  warning_environments:
    - dev
    - staging
