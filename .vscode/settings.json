{
  // ── TypeScript language server ───────────────────────────
  // Large monorepo: 58 tsconfig files, 49 packages, 10 apps.
  // Raise the heap ceiling so tsserver stops crashing / OOM-ing.
  "typescript.tsserver.maxTsServerMemory": 12288,
  // Use the workspace's own TypeScript installation (keeps versions in sync).
  "typescript.tsdk": "node_modules/typescript/lib",
  // Exclude heavy generated artefacts from tsserver's watch list.
  "typescript.tsserver.watchOptions": {
    "excludeDirectories": [
      "**/node_modules",
      "**/.next",
      "**/dist",
      "**/.turbo",
      "**/.tsbuildinfo",
      "**/coverage",
      "**/.venv"
    ]
  },
  // Disable project-wide diagnostics — at this scale tsserver tries to
  // type-check EVERY file in EVERY project in the background, which is
  // the #1 cause of the OOM crashes.
  "typescript.tsserver.experimental.enableProjectDiagnostics": false,
  // Scanning all 49+ packages for auto-imports is very expensive.
  // "auto" limits it to packages in your dependencies.
  "typescript.preferences.includePackageJsonAutoImports": "auto",
  // Use VS Code's native file watcher instead of tsserver's own polling,
  // which duplicates effort and adds heap pressure.
  "typescript.tsserver.experimental.useVsCodeWatcher": true,

  // ── File watcher / search exclusions ────────────────────
  // Prevents VS Code from watching these large trees (saves memory + CPU).
  "files.watcherExclude": {
    "**/node_modules/**": true,
    "**/.next/**": true,
    "**/dist/**": true,
    "**/.turbo/**": true,
    "**/coverage/**": true,
    "**/.venv/**": true,
    "**/.tsbuildinfo": true
  },
  // Keep these out of Quick Open / search results.
  "search.exclude": {
    "**/node_modules": true,
    "**/.next": true,
    "**/dist": true,
    "**/.turbo": true,
    "**/coverage": true,
    "**/pnpm-lock.yaml": true
  },
  // Don't track symlinks — pnpm creates many via node_modules.
  "search.followSymlinks": false,

  // ── Python ──────────────────────────────────────────────
  // Cross-platform: Linux-first (VPS), Windows fallback via env override
  "python.defaultInterpreterPath": "${workspaceFolder}/.venv/bin/python",
  "python.terminal.activateEnvironment": true,
  "python.analysis.typeCheckingMode": "basic",
  "python.analysis.autoImportCompletions": true,
  // tooling/ml scripts use their own venv (requirements.txt) — suppress
  // "could not be resolved" errors for packages not in the workspace venv.
  "python.analysis.ignore": [
    "tooling/ml/**",
    // Satellite repos have their own venv + pyrightconfig.json.
    // Suppress Pylance analysis from the automation workspace context
    // to avoid false "could not be resolved" Django/pytest errors.
    "../nzila-abr-insights/backend/**",
    "../nzila-union-eyes/backend/**"
  ],
  "python.testing.pytestEnabled": true,
  "python.testing.pytestArgs": [
    "packages/automation"
  ],

  // ── Editor defaults ─────────────────────────────────────
  "[python]": {
    "editor.defaultFormatter": "ms-python.black-formatter",
    "editor.formatOnSave": true,
    "editor.codeActionsOnSave": {
      "source.organizeImports": "explicit"
    }
  },
  "chat.tools.terminal.autoApprove": {
    "npx vitest": true
  },

  // ── SQL ─────────────────────────────────────────────────
  // Drizzle migrations are PostgreSQL.
  // Associate with "pgsql" so the MSSQL extension does not lint them —
  // MSSQL syntax like REPLACE/RAISE/BEFORE TRIGGER is invalid TSQL
  // but perfectly valid PostgreSQL, causing false-positive errors.
  "files.associations": {
    "packages/db/drizzle/**/*.sql": "pgsql"
  },
  // Disable MSSQL linting workspace-wide: this repo targets PostgreSQL only.
  "mssql.linting.enable": false,
  "vitest.disableWorkspaceWarning": true
}
