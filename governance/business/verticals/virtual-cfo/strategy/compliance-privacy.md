# Virtual-CFO â€” Compliance & Privacy Strategy

> Regulatory compliance framework for Insight CFO â€” financial data privacy, accounting standards, and security requirements.

---

## Financial Data Regulations

### PIPEDA Compliance (Primary)
- **Scope**: Insight CFO processes highly sensitive financial data (bank transactions, revenue, expenses, tax filings, customer/vendor lists)
- **Data controller**: SMB client (controller), Insight CFO (processor)
- **Data processing agreement (DPA)**: Mandatory with every client â€” covers financial data handling, breach notification, data return/deletion
- **Consent model**: Business owner provides explicit consent during onboarding; employees/bookkeepers added by authorized admin
- **Breach notification**: 72-hour notification to Privacy Commissioner + affected clients
- **Access rights**: Clients can export all data (CSV/JSON) and request full deletion at any time

### Data Classification
| Data Category | Sensitivity | Retention | Examples |
|---|---|---|---|
| **Financial transactions** | High | Active + 7yr (CRA requirement) | Revenue, expenses, journal entries |
| **Tax information** | High | Active + 7yr | GST/HST filings, tax estimates, CRA deadlines |
| **Bank connection tokens** | Critical | Active only (revoked on disconnect) | QBO OAuth tokens, Xero tokens |
| **Customer/vendor lists** | Medium | Active + 1yr | Names, contact info, payment history |
| **User account data** | Medium | Active + 1yr | Email, name, role, login history |
| **Dashboard preferences** | Low | Active only | Layout, favorites, notification settings |
| **Aggregated analytics** | Low | Indefinite (anonymized) | Industry benchmarks, usage patterns |

### Quebec â€” Law 25
- Privacy officer designated for financial data operations
- Privacy Impact Assessment (PIA) completed for accounting platform integrations
- Consent management: explicit opt-in before connecting accounting software
- Data portability: full export in standardized format (CSV, PDF reports)
- De-identification: anonymization of benchmark data (no individual business identifiable)
- French language: complete privacy notice, terms, DPA available in French

---

## CRA Tax Compliance

### Record Keeping Requirements
- Canadian businesses must keep financial records for **6 years** from end of tax year (Income Tax Act s.230)
- Insight CFO maintains financial data for **7 years** (buffer for CRA audit window)
- Records must be kept in Canada or with CRA authorization for foreign storage
- **Data residency**: Supabase hosted in Canadian region (or US with DPA covering cross-border transfer requirements)

### Tax Data Accuracy
- Insight CFO provides **estimates only** â€” not a tax filing tool
- Clear disclaimers: "Tax estimates are approximate. Consult your CPA for filing."
- No direct CRA filing integration (liability risk) â€” provide preparation data to CPA
- GST/HST calculations based on QBO/Xero data â€” not authoritative for filing purposes

### Audit Support
- Data export in CRA-compatible format for audit requests
- Transaction-level detail with source tracing (QBO transaction ID, date, amount)
- Audit log: every data access, export, and modification tracked
- CPA access: read-only CPA portal allows auditors to review without client involvement

---

## Accounting Standards Alignment

### ASPE (Accounting Standards for Private Enterprises)
- Insight CFO financial statements follow ASPE presentation standards
- Chart of accounts mapping aligned with standard Canadian COA templates
- Financial statement templates: standard ASPE format for balance sheet, income statement, cash flow
- Note: Insight CFO generates **management reports**, not audited financial statements

### IFRS Awareness (Future)
- For larger clients transitioning to IFRS, provide IFRS-compatible report formats
- Revenue recognition guidance aligned with IFRS 15 principles
- Lease accounting awareness for IFRS 16 impact analysis

### Professional Disclaimers
```
All financial reports generated by Insight CFO are for management 
information purposes only. They do not constitute audited financial 
statements, professional accounting advice, or tax advice. Users 
should consult a qualified CPA for financial statement preparation, 
tax filing, and compliance matters.

Insight CFO is not a registered accounting firm and does not provide 
professional accounting services as defined by provincial CPA Acts.
```

---

## Security Framework

### Data Security Controls
| Control | Implementation | Status |
|---|---|---|
| **Encryption at rest** | AES-256 (Supabase managed) | âœ… Active |
| **Encryption in transit** | TLS 1.3 all connections | âœ… Active |
| **Row-Level Security** | Supabase RLS on every table | âœ… Active |
| **OAuth token storage** | Supabase Vault (encrypted) | âœ… Active |
| **MFA** | Supabase Auth (TOTP + SMS) | âœ… Available |
| **API rate limiting** | Supabase built-in | âœ… Active |
| **Data backup** | Daily automated (Supabase) | âœ… Active |
| **Disaster recovery** | Point-in-time recovery (PITR) | âœ… Pro plan |
| **Penetration testing** | Annual third-party | âŒ Planned 2026 |
| **Vulnerability scanning** | Quarterly automated | ğŸ”„ Monthly target |
| **SOC 2 Type II** | Supabase platform-level | âœ… Inherited |

### Authentication & Authorization
```
Role-Based Access Control:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Role: Owner                                     â”‚
â”‚ â€¢ Full read/write to all financial data         â”‚
â”‚ â€¢ User management (invite/remove)               â”‚
â”‚ â€¢ Accounting software connections               â”‚
â”‚ â€¢ Billing and subscription management           â”‚
â”‚                                                  â”‚
â”‚ Role: Admin                                     â”‚
â”‚ â€¢ Full read/write to financial data             â”‚
â”‚ â€¢ Cannot manage billing or connections          â”‚
â”‚                                                  â”‚
â”‚ Role: Viewer                                    â”‚
â”‚ â€¢ Read-only access to dashboards and reports    â”‚
â”‚ â€¢ Cannot export raw transaction data            â”‚
â”‚                                                  â”‚
â”‚ Role: CPA                                       â”‚
â”‚ â€¢ Read-only access to linked client data        â”‚
â”‚ â€¢ Export reports (white-labeled)                 â”‚
â”‚ â€¢ Cannot modify client data                     â”‚
â”‚ â€¢ Access controlled by cpa_client_links table   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Accounting Platform Security
- **OAuth 2.0 only**: No direct password storage for QBO/Xero
- **Read-only access**: Insight CFO requests minimum API scopes (read transactions, read accounts)
- **Token rotation**: OAuth refresh tokens rotated on each use
- **Connection revocation**: Users can disconnect accounting software instantly â€” tokens destroyed
- **Webhook validation**: Signed webhook payloads from QBO/Xero verified before processing

---

## Third-Party Data Handling

### Sub-Processor Register
| Sub-Processor | Purpose | Data Shared | Location | DPA |
|---|---|---|---|---|
| **Supabase** | Database, auth, storage, functions | All platform data | US-East / CA (planned) | âœ… |
| **QuickBooks (Intuit)** | Accounting data sync | OAuth tokens, sync metadata | US | âœ… (Intuit TOS) |
| **Xero** | Accounting data sync (future) | OAuth tokens, sync metadata | AU/US | âœ… (Xero DPA) |
| **Stripe** | Subscription billing | Client billing info (tokenized) | US | âœ… |
| **Sentry** | Error monitoring | Anonymized error data | US | âœ… |
| **Resend** | Transactional email | User email addresses | US | âœ… |

### Data Flow Diagram
```
QuickBooks Online â”€â”€(OAuth API, read-only)â”€â”€â†’ Supabase Edge Function
                                                      â”‚
                                              Transform & Validate
                                                      â”‚
                                                      â–¼
                                              PostgreSQL (RLS)
                                                      â”‚
                                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”
                                              â”‚               â”‚
                                        SMB Dashboard    CPA Portal
                                         (client owns)   (read-only)
```

### Data Portability & Deletion
- **Full export**: CSV export of all financial data at any time (one-click in Settings)
- **Report export**: PDF export of all generated reports
- **Account deletion**: Owner can request full data deletion â€” executed within 30 days
- **Post-deletion**: Only anonymized aggregate data retained for benchmarking
- **CRA retention override**: Client notified that deleting data before 7-year retention may impact CRA compliance

---

## Compliance Roadmap

### 2025 â€” Foundation
- PIPEDA compliance framework + privacy policy + DPA template
- Supabase RLS policies on all 30 tables
- OAuth 2.0 implementation for QBO (read-only scopes)
- Financial disclaimers on all reports
- Basic audit logging (login, data export, connection events)
- Data retention policy documentation

### 2026 â€” Maturation
- Law 25 (Quebec) full compliance
- Annual penetration testing program
- CPA firm data access audit trail
- Incident response plan (tested via tabletop)
- Enhanced audit logging (all data access events)
- Data classification labels in Supabase metadata
- Sub-processor management framework

### 2027 â€” Certification & Expansion
- SOC 2 Type II readiness assessment
- CCPA/CPRA readiness (US expansion)
- Canadian data residency confirmed (Supabase CA region)
- Cross-border data transfer agreements (US CPA clients)
- Business continuity plan tested
- Third-party security audit (annual program)

### 2028 â€” Enterprise-Ready
- SOC 2 Type II certification (if customer demand warrants)
- GDPR awareness (EU expansion consideration)
- ISO 27001 gap analysis
- Automated compliance monitoring and alerting
- Privacy by design embedded in development lifecycle
- Annual compliance report for enterprise clients

---

## Regulatory Risk Considerations

### Key Risks
| Risk | Likelihood | Impact | Mitigation |
|---|---|---|---|
| CRA data request | Medium | Medium | 7-year retention, export-ready format |
| PIPEDA breach | Low | High | Encryption, RLS, breach response plan |
| CPA Act violation | Low | High | Clear disclaimers â€” "not accounting advice" |
| QuickBooks API changes | Medium | Medium | Abstraction layer, multi-platform support |
| Cross-border data issue | Low | Medium | Canadian hosting, DPAs in place |
| Client bankruptcy (data access) | Medium | Low | Data export on demand, trustee access procedure |
